<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>
</head>
<body>
    <input type="file" id="one"/>
    <div style="width: 200px;height: 200px;border: 1px solid red;" id="dropDoc"></div>
    <div id="container"></div>
    <div id="container1"></div>
</body>
<script src="shim.js"></script>
<script src="cpexcel.js"></script>
<script src="xlsx.full.min.js"></script>
<script>
    var aoa = [
        ["This",  "is", "a",    "Test"],
        ["Fee",   "Fi", "Fo",   "Fum"],
        [1,       2,    3,      4],
        ["Click", "to", "edit", "cells"]
    ];
    var ws = XLSX.utils.aoa_to_sheet(aoa);
    console.log(ws);
    document.getElementById("container").innerHTML = XLSX.utils.sheet_to_html(ws, { editable:true }).replace("<table>", '<table style="border-collapse: collapse" id="table" border="1">');
    /* processing array buffers, only required for readAsArrayBuffer */
    function fixdata(data) {
        var o = "", l = 0, w = 10240;
        for(; l<data.byteLength/w; ++l) o+=String.fromCharCode.apply(null,new Uint8Array(data.slice(l*w,l*w+w)));
        o+=String.fromCharCode.apply(null, new Uint8Array(data.slice(l*w)));
        return o;
    }

    var rABS = true; // true: readAsBinaryString ; false: readAsArrayBuffer
    /* set up drag-and-drop event */
    function handleDrop(e) {
        e.stopPropagation();
        e.preventDefault();
        var files = e.dataTransfer.files;
        var i,f;
        for (i = 0; i != files.length; ++i) {
            f = files[i];
            var reader = new FileReader();
            var name = f.name;
            reader.onload = function(e) {
                var data = e.target.result;

                var workbook;
                if(rABS) {
                    /* if binary string, read with type 'binary' */
                    workbook = XLSX.read(data, {type: 'binary'});
                } else {
                    /* if array buffer, convert to base64 */
                    var arr = fixdata(data);
                    workbook = XLSX.read(btoa(arr), {type: 'base64'});
                }

                /* DO SOMETHING WITH workbook HERE */
            };
            if(rABS) reader.readAsBinaryString(f);
            else reader.readAsArrayBuffer(f);
        }
    }
    var drop_dom_element = document.getElementById('dropDoc');
    drop_dom_element.addEventListener('drop', handleDrop, false);

    //获取文件
    function handleFile(e) {
        var files = e.target.files;
        var i,f;
        for (i = 0; i != files.length; ++i) {
            f = files[i];
            var reader = new FileReader();
            var name = f.name;
            reader.onload = function(e) {
                var data = e.target.result;
                var workbook;
                if(rABS) {
                    /* if binary string, read with type 'binary' */
                    workbook = XLSX.read(data, {type: 'binary'});
                } else {
                    /* if array buffer, convert to base64 */
                    var arr = fixdata(data);
                    workbook = XLSX.read(btoa(arr), {type: 'base64'});

                }
                document.getElementById("container1").innerHTML=  XLSX.utils.sheet_to_html(workbook.Sheets[workbook.SheetNames[0]]).replace('<table>','<table style="border-collapse: collapse" id="table" border="1">');

                console.log(workbook);
                console.log(workbook.Sheets['Sheet1']);
                /* DO SOMETHING WITH workbook HERE */
            };
            reader.readAsBinaryString(f);
        }
    }
    var input_dom_element = document.getElementById('one');
    input_dom_element.addEventListener('change', handleFile, false);
</script>
</html>